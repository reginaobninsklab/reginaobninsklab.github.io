---
title: "–í—ã–±–æ—Ä—ã –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ (–ß–∞—Å—Ç—å 1. –ö–∞–Ω–¥–∏–¥–∞—Ç—ã —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é)"
description: |
  –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞—Ö –≤ –¥–µ–ø—É—Ç–∞—Ç—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤ –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∏ –ó–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Å–æ–±—Ä–∞–Ω–∏—è –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤ –ø–µ—Ä–∏–æ–¥ —Å 2009 –ø–æ 2023 –≥–æ–¥. –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± —É—á–∞—Å—Ç–∏–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ –ø–ª–∏—Ç–æ—á–Ω—ã—Ö –∫–∞—Ä—Ç.  
date: 2024-06-30
categories:
  - –∫–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
  - –≤—ã–±–æ—Ä—ã
  - –¥–µ–ø—É—Ç–∞—Ç—ã
  - –ø–ª–∏—Ç–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞
output:
  distill::distill_article:
    self_contained: false
    code_folding: false
    highlight: kate
    highlight_downlit: true
    toc: true
    toc_depth: 3
    toc_float: true
preview: images/cands_share_kaluga_tiles.png
draft: null
citation: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
Sys.setlocale("LC_CTYPE","russian")
Sys.setlocale("LC_COLLATE","russian")
Sys.setlocale("LC_TIME", "russian")
list("dplyr", "readr", "tidyr", "purrr", "stringr", "ggplot2", 
     "ggtext", "showtext", "DT", "rmarkdown", "scales", "patchwork") |>
  purrr::walk(~suppressWarnings(suppressPackageStartupMessages(
    library(.x, character.only = TRUE, quietly = T))))

options(readr.show_col_types = FALSE)

dir <- paste0(Sys.getenv("OneDrive"), "/ODCity/")
dir_charts <- paste0(getwd(), "/images/")
if(!dir.exists(dir_charts)){ dir.create(dir_charts) }

dir0 <- paste0(Sys.getenv("OneDrive"), "/ODCity/deps/")

options(DT.options = list(pageLength = 10, lengthMenu = c(5, 10, 20), 
                          dom = "Blfrtip", buttons = c('copy', 'csv', 'excel'),
            deferRender = TRUE, ordering = TRUE, autoWidth = TRUE, 
            language = list(url = 'https://cdn.datatables.net/plug-ins/1.10.11/i18n/Russian.json')))

table_caption_css <- 'caption-side: bottom; font-family: Play; font-stretch: condensed;color: #999999; text-align: left;'
```

```{r ggplot_setup}
showtext::showtext_opts(dpi = 192)

local_font_folder <- paste0(Sys.getenv("OneDrive"), "/gfonts/")

font_add("RobotoC", regular = paste0(local_font_folder, 
                          "Roboto_Condensed/RobotoCondensed-Regular.ttf"))

font_add("Oswald", regular = paste0(local_font_folder, 
                            "Oswald/Oswald-Regular.ttf"))

font_add("Sofia", 
         regular = paste0(local_font_folder,
                          "Sofia_Sans_Condensed/static/SofiaSansCondensed-Regular.ttf"),
         bold = paste0(local_font_folder,
                          "Sofia_Sans_Condensed/static/SofiaSansCondensed-SemiBold.ttf"))

sysfonts::font_add("fa_brands",
         regular = paste0(local_font_folder, 
                         "/fontawesome/otfs/Font Awesome 6 Brands-Regular-400.otf"))

sysfonts::font_add("fa_solid", 
         regular = paste0(local_font_folder, 
                         "/fontawesome/otfs/Font Awesome 6 Free-Solid-900.otf"))

wrap_fa_brands <- function(text, color, font_size){
  paste0("<span style='font-family:\"fa_brands\"; font-size:", font_size, "pt; color:", color, ";'>", text, "</span>")
}
wrap_fa_solids <- function(text, color, font_size){
  paste0("<span style='font-family:\"fa_solid\"; font-size:", font_size, "pt; color:", color, ";'>", text, "</span>")
}
wrap_text <- function(text, color, font_size){
  paste0("<span style='font-family:\"Sofia\"; font-size:", font_size, "pt; color:", color, ";'>", text, "</span>")
}

regina_caption <- paste0(
"<span style='font-family:\"fa_brands\"; font-size:\"12pt\"; color:#232323;'>&#xf2c6;</span>  ", 
"<span style='font-family:\"Sofia\"; color:#232323; font-size:\"12pt\"'> Regina_Lab</span>",
"<span style='font-family:\"Sofia\"; color:#232323; font-size:\"22pt\"'> </span>",
"<br/>", wrap_fa_brands("&#xf25e;&#xf4e7;", color = "#232323;", 9), " ",
wrap_text(paste0(" –ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ —É—Å–ª–æ–≤–∏—è—Ö –æ—Ç–∫—Ä—ã—Ç–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏ Creative Commons CC BY 4.0.",
"<span> &nbsp;</span>",
" –®—Ä–∏—Ñ—Ç—ã: Font Awesome Free \\(SIL OFL 1.1\\), Sofia Sans Condensed \\(SIL OFL 1.1\\), ",
"Roboto Condensed \\(Apache License 2.0\\)."), color = "#232323;", 8))

showtext_auto()

my_theme <- theme(
  axis.line = element_line(colour = "#827C82", linewidth = 0.2),  
  axis.ticks=element_line(colour = "#827C82", linewidth = 0.2),  
  axis.text=element_text(colour = "#6b676b", family = "RobotoC", size = rel(1)),
  axis.title = element_text(colour = "#292726", 
                            family = "RobotoC", size = rel(1.1)),
  plot.background = element_rect(fill = "white", colour = NA),
  panel.background = element_rect(fill = "white"),
  panel.border = element_rect(fill = NA, colour = "white"),
  panel.grid.minor = element_blank(), 
  panel.grid.major.y = element_line(colour = "#827C82", linewidth = 0.1),
  panel.grid.major.x = element_blank(),
  plot.margin = unit(c(t=0.2,r=0.1,b=0.1,l=0.1), "cm"),
  plot.title.position = "plot", 
  plot.caption.position = "plot",
  plot.title = element_text(size = 24, hjust = 0, margin = margin(0,0,0,0,'mm'),
                            face = "bold", colour = "#232323", family = "Sofia"), 
  plot.subtitle = element_markdown(halign = 0, hjust = 0, 
                                   margin = margin(2,0,2,0,'mm')),
  plot.caption = element_markdown(halign = 0, hjust = 0),
  strip.text = element_text(hjust = 0.5, vjust = 0.5, 
                            family = "RobotoC", margin = margin(1,0,1,1,'mm'),
                            face = "bold", size = rel(1.2), colour = "#292726"),  
  strip.background = element_rect(fill = "grey90", color = "grey90"))

  my_theme_x <- my_theme + 
    theme(axis.line = element_blank(),  axis.ticks=element_blank(),
          axis.text=element_blank(), axis.title = element_blank(),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_blank())
```

–í –ø—Ä–æ—à–ª–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –º—ã –ø–æ–∫–∞–∑–∞–ª–∏ –∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç—å [–ø–ª–∏—Ç–æ—á–Ω—É—é –∫–∞—Ä—Ç—É –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏](https://reginaobninsklab.github.io/posts/kaluga-tilemap/){target="_blank"}, —Å–∞–º–æ–µ –≤—Ä–µ–º—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å –µ—ë –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –í –∫–∞—á–µ—Å—Ç–≤–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–µ–¥–µ–Ω–∏—è –æ –≤—ã–±–æ—Ä–∞—Ö –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏. 

```{r setting map}
temp_grid <- paste0(Sys.getenv("OneDrive"), 
                    "/Russian_tilemaps/Russian_TileMap_grids.xlsx") %>% 
  readxl::read_xlsx(sheet = "kaluga_region") %>% 
  bind_rows(tibble(row = 6, col = 7, code = "–ó–∞–∫–°–æ–±", 
                   egryul_region = "–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å"))
```

### –°–≤–µ–¥–µ–Ω–∏—è –æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞—Ö

```{r}
sud <- readxl::read_xlsx(paste0(dir0, "sudim_m.xlsx"), col_types = "text") |> 
  filter(articles!="–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö") %>% 
  mutate(n_crimes = str_count(articles, "\\|") + 1) %>% 
  mutate(across(starts_with("god"), 
                ~ifelse(str_detect(.x, "^\\d{5}$"),  
                        format(as.Date(as.numeric(.x), origin = "1900-01-01"), 
                               "%d.%m.%Y"), .x))) |> 
  mutate(across(articles, ~str_split(.x, " \\| "))) %>% 
  unnest(c(articles), keep_empty = T) |> distinct() %>% 
  mutate(arts = str_split(articles, enc2utf8("\\,\\s(?=—Å—Ç\\.\\d)|\\|"))) %>% 
  unnest(arts,  keep_empty = T) %>% 
  mutate(arts = str_extract_all(arts, enc2utf8('—Å—Ç.\\d+[^\\"]*\\"[^\\"]+\\"'))) %>% 
  unnest(arts, keep_empty = T) %>% 
  summarize(.by = c(personId, n_crimes),
            arts = paste(sort(unique(arts)), collapse = " | ")) %>% 
  distinct()

cand_stat <- arrow::read_parquet(paste0(dir0, "deps_stat_final.parquet")) |> 
  filter(!grepl("–ï–î–ò–ù–ê", event, ignore.case = T)) %>% 
  mutate(rayon2 = ifelse(rayon2 == "–°–µ–ª–æ –ë–µ—Ä–µ–∑–∏—á—Å–∫–∏–π —Å—Ç–µ–∫–ª–æ–∑–∞–≤–æ–¥",
                         enc2utf8("–ö–æ–∑–µ–ª—å—Å–∫–∏–π —Ä–∞–π–æ–Ω"), rayon2)) |> 
  mutate(rayon2 = ifelse(grepl(enc2utf8("–ö–∏—Ä–æ–≤.–∫–∏–π"), rayon2), 
                        enc2utf8("–ö–∏—Ä–æ–≤—Å–∫–∏–π —Ä–∞–π–æ–Ω"), rayon2)) %>% 
  select(- n_crimes, -arts) |> 
  left_join(sud, by = join_by(personId))
```

–û–ø—Ä–µ–¥–µ–ª–∏–º—Å—è —Å —Ç–µ—Ä–º–∏–Ω–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

- **–≤—ã–¥–≤–∏–∂–µ–Ω–∏–µ** -- —É—á–∞—Å—Ç–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –≤ –≤—ã–±–æ—Ä–∞—Ö –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ä–≥–∞–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥–æ–¥. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã–¥–≤–∏–∂–µ–Ω–∏–π -- –≤ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ—Ä–≥–∞–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å–Ω–æ–π –≤–ª–∞—Å—Ç–∏ –≤ —Ä–∞–∑–Ω—ã–µ –≥–æ–¥—ã, –∏–ª–∏ –≤ —Ä–∞–∑–Ω—ã–µ –æ—Ä–≥–∞–Ω—ã –≤ –æ–¥–∏–Ω –≥–æ–¥, –∞ –∏–Ω–æ–≥–¥–∞ –∏ —Ç–æ, –∏ –¥—Ä—É–≥–æ–µ. 

- **–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ä–≥–∞–Ω—ã** - —ç—Ç–∏–º —Ç–µ—Ä–º–∏–Ω–æ–≤ –±—É–¥–µ–º –æ–±–æ–∑–Ω–∞—á–∞—Ç—å –≤—Å—è–∫–æ–≥–æ —Ä–æ–¥–∞ –¥—É–º—ã –∏ —Å–æ–±—Ä–∞–Ω–∏—è –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Å—Ç.130-133 –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ –†–§ –∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è–º–∏ –§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–∞ –æ—Ç 06.10.2003 N 131-–§–ó (—Ä–µ–¥. –æ—Ç 15.05.2024) "–û–± –æ–±—â–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –º–µ—Å—Ç–Ω–æ–≥–æ —Å–∞–º–æ—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏" —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –ø—É—Ç–µ–º –≤—ã–±–æ—Ä–æ–≤, –∞ —Ç–∞–∫–∂–µ –ó–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å–Ω—ã–º –∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å–Ω—ã–º –æ—Ä–≥–∞–Ω–æ–º –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –≤–ª–∞—Å—Ç–∏ –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏. 

–ú—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —Å–≤–µ–¥–µ–Ω–∏—è –æ **`r nrow(cand_stat)`** –≤—ã–¥–≤–∏–∂–µ–Ω–∏—è—Ö, –∑–∞—Ö–≤–∞—Ç–∏–≤ 3 –≤–æ–ª–Ω—ã –≤—ã–±–æ—Ä–æ–≤ -- 2010, 2015, 2020, –∞ —Ç–∞–∫–∂–µ –≤—Å—ë —Ç–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –º–µ–∂–¥—É –Ω–∏–º–∏ (–ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤—ã–±–æ—Ä—ã).

```{r}
dynamic_chart <- paste0(dir_charts, "dynamic.png") 
if(!file.exists(dynamic_chart)){
  gg <- cand_stat |> 
  summarize(.by = year, 
            "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤" = n_distinct(personId),
            "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–¥–≤–∏–∂–µ–Ω–∏–π" = n_distinct(url_event)) |>
  pivot_longer(-1, names_to = "type", values_to = "n") |> 
  ggplot() + 
  geom_col(aes(x = year, y = n, fill = type)) + 
  facet_wrap(~type, scales = "free", ncol = 1) + 
  labs(title = "–í—ã–¥–≤–∏–∂–µ–Ω–∏—è –∏ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã - –≤—ã–±–æ—Ä—ã –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ 2009-23 –≥–≥.",
       subtitle = "–î–∞–Ω–Ω—ã–µ: –≤–µ–±-—Å–∞–π—Ç—ã –¶–ò–ö –†–æ—Å—Å–∏–∏ –∏ vyboroteka.ru<br/>",
       x = "–ì–æ–¥ –≤—ã–±–æ—Ä–æ–≤", y = NULL,
       caption = regina_caption) +
    scale_fill_manual(values = c('#FF420EFF', '#004586FF'))+
    guides(fill = "none") + 
  my_theme

  ggsave(gg, filename=dynamic_chart, width=22, height = 16.5, units="cm", dpi=196)
}
knitr::include_graphics(dynamic_chart)
```

```{r}
sud_stat_all <- cand_stat %>% 
  summarize(.by = rayon2, 
            n_places = n(), 
            n_cands = n_distinct(personId))

sud_stat_wsud <- cand_stat %>% 
  filter(!is.na(n_crimes)) %>% 
  mutate(recid = ifelse(n_crimes>1, personId, NA_character_)) %>% 
  summarize(.by = rayon2, 
            n_places_wsud = n(), 
            n_places_wsud2 = sum(!is.na(recid)),
            n_cands_wsud = n_distinct(personId, na.rm = T),
            n_cands_wsud2 = n_distinct(recid, na.rm = T))

sud_stat <- sud_stat_all %>% 
  left_join(sud_stat_wsud, by = join_by(rayon2)) %>%
  mutate(across(contains("wsud"), ~ifelse(is.na(.x), 0, .x))) %>% 
  mutate(sh_place = n_places_wsud/n_places, 
         sh_place2 = n_places_wsud2/n_places,
         sh_cand = n_cands_wsud/n_cands, 
         sh_cand2 = n_cands_wsud2/n_cands) %>% 
  rename(egryul_region = rayon2) %>% 
  mutate(egryul_region = gsub("–≥. ", "", egryul_region)) %>%
  right_join(temp_grid, by = join_by(egryul_region)) %>% 
  replace_na(list(value = 0)) %>% 
  arrange(-sh_cand)
```

### –°–≤–µ–¥–µ–Ω–∏—è –æ —Å—É–¥–∏–º–æ—Å—Ç–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤

–°–≤–µ–¥–µ–Ω–∏—è –æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞—Ö –Ω–∞ —Å–∞–π—Ç–µ –¶–ò–ö –†–æ—Å—Å–∏–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö (*—á—Ç–æ –¥–∞–ª–∏, —Ç–æ –∏ –µ—Å—Ç—å*). –ü–æ—ç—Ç–æ–º—É –Ω–∞–º –ø—Ä–∏—à–ª–æ—Å—å –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∏ —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö:

–∞) –µ—Å–ª–∏ –≤ —Å–≤–µ–¥–µ–Ω–∏—è—Ö –æ —Å—É–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∞—Ç –æ—Å—É–∂–¥–µ–Ω–∏—è –∏–ª–∏ –ø–æ–≥–∞—à–µ–Ω–∏—è —Å—É–¥–∏–º–æ—Å—Ç–∏, –º—ã –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞–ª–∏ –º–∞–∫—Å–∏–º—É–º —É—Å–∏–ª–∏–π, —á—Ç–æ–±—ã —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Å—Ç–∞—Ç—å–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Å—É–∂–¥–µ–Ω–∏—è –∏ –≤—ã–¥–µ–ª–∏—Ç—å —ç—Ç–∏ –¥–∞—Ç—ã.

–±) –µ—Å–ª–∏ –≤ —Å–≤–µ–¥–µ–Ω–∏—è—Ö –æ —Å—É–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–∏—Å—É—Ç—Å–≤–æ–≤–∞–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞—Ç–µ–π —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —á–∞—Å—Ç–µ–π –∏–ª–∏ –ø—É–Ω–∫—Ç–æ–≤, –º—ã –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞–ª–∏ –º–∞–∫—Å–∏–º—É–º —É—Å–∏–ª–∏–π, —á—Ç–æ–±—ã —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Å—Ç–∞—Ç—å–∏ –∏ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å–∏. 

> –ú—ã –Ω–µ –∑–∞–Ω–∏–º–∞–ª–∏—Å—å —Å–±–æ—Ä–æ–º –∏–Ω—ã—Ö —Å–≤–µ–¥–µ–Ω–∏–π –æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞—Ö, –∏—Ö –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏—è—Ö –∏ —Ç.–¥.

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ 

–°–≤–µ–¥–µ–Ω–∏—è –æ –≤—ã–¥–≤–∏–∂–µ–Ω–∏—è—Ö –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ä–≥–∞–Ω—ã —Å–µ–ª—å—Å–∫–∏—Ö –∏ –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –ø–æ—Å–µ–ª–µ–Ω–∏–π –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω—ã –¥–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ (–≤—Å–µ–≥–æ -- 24),  —Å–≤–µ–¥–µ–Ω–∏—è –æ –≤—ã–¥–≤–∏–∂–µ–Ω–∏—è—Ö –≤ –ì–æ—Ä–æ–¥—Å–∫–æ–µ –°–æ–±—Ä–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –û–±–Ω–∏–Ω—Å–∫, –ì–æ—Ä–æ–¥—Å–∫—É—é –î—É–º—É –ö–∞–ª—É–≥–∏ –∏ –ó–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –ø–æ–∫–∞–∑–∞–Ω—ã –∫–∞–∫ –µ—Å—Ç—å. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–ª—è 27 —Å—É–±—ä–µ–∫—Ç–∞—Ö.  

–í —Ç–∞–±–ª–∏—Ü–µ –Ω–∏–∂–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ 27 —Å—É–±—ä–µ–∫—Ç–æ–≤ –ø–æ–∫–∞–∑–∞–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–¥–≤–∏–∂–µ–Ω–∏–π (–í—ã–¥–≤) –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (–ö–∞–Ω–¥), –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é (–°—É–¥) –∏ —Å –±–æ–ª–µ–µ —á–µ–º 1 —Å—É–¥–∏–º–æ—Å—Ç—å—é (–°—É–¥+).

```{r}
sud_stat %>% 
  select("–°—É–±—ä–µ–∫—Ç" = egryul_region, 
         "–í—ã–¥–≤" = n_places, "–í—ã–¥–≤C—É–¥" = n_places_wsud, "–í—ã–¥–≤C—É–¥+" = n_places_wsud2, 
         "–ö–∞–Ω–¥" = n_cands, "–ö–∞–Ω–¥–°—É–¥" = n_cands_wsud, "–ö–∞–Ω–¥–°—É–¥+" = n_cands_wsud2) %>% 
  datatable(rownames = F, escape = F,
             caption = htmltools::tags$caption(style = table_caption_css, paste0(' ')), 
          options = list(columnDefs = list(list(className = 'dt-center', targets = c(1:6)))))
```

–≠—Ç–∏ –∂–µ —Ü–∏—Ñ—Ä—ã, –Ω–æ —Ç–µ–ø–µ—Ä—å –≤ –≤–∏–¥–µ –ø–ª–∏—Ç–æ—á–Ω–æ–π –∫–∞—Ä—Ç—ã.

```{r}
tilemap_base <- function(data){
  ggplot(data) + 
    # boxes
    geom_rect(aes(xmin=col-0.45, xmax=col+0.45, ymin=row-0.45, ymax=row+0.45, 
                  fill=log2(value)+1), colour="grey60", linewidth=0.15) +
    geom_rect(aes(xmin=col-0.45, xmax=col+0.45, ymin=row-0.1, ymax=row-0.45), 
              fill="#716991") +
    # texts
    geom_text(data = data %>% filter(!code %in% c("040", "–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å")),
              aes(x=col, y=row-0.28, label=code),
              size=3, color="white", family = "RobotoCondensed")+
    geom_label(data = data %>% filter(code %in% "040"),
              aes(x=col, y=row-0.28, label= "–ö–ê–õ–£–ì–ê"), fill = NA,
              label.padding = unit(0.12, "lines"),
              label.r = unit(0.1, "lines"), label.size = 0.2,
               size=3, color="white", family = "RobotoCondensed")+
    geom_label(data = data %>% filter(code %in% "–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å"),
              aes(x=col, y=row-0.28, label= code), fill = NA,
              label.padding = unit(0.12, "lines"),
              label.r = unit(0.1, "lines"), label.size = 0.2,
               size=3, color="white", family = "RobotoCondensed")+
    geom_text(aes(x=col, y=row+0.15, label= value_label), 
              size=4.5, fontface="bold", color="grey30", 
              family = "RobotoCondensed")+
    scale_y_reverse(name = NULL)+ scale_x_continuous(name = NULL) + 
    scale_fill_gradient(low="#FFF68C", high="#F26111",na.value = "white")+
    coord_equal() + 
    guides(fill = "none")+ 
    my_theme_x
}
```

```{r}
data_tag <- "cands_share"    # <- will be used in the chart filenames!

sh_place1 <- paste0(dir_charts, data_tag, "_kaluga_tiles.png")
if(!file.exists(sh_place1)){
  gg1 <- sud_stat |> 
   rename(value = sh_place) %>% 
   mutate(value_label = ifelse(value<0.00001, "0%", 
                              scales::percent(value, accuracy = 0.1))) %>% 
   tilemap_base() + 
   labs(subtitle = paste0("–ß–∞—Å—Ç–æ—Ç–∞ —É—á–∞—Å—Ç–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é, %", 
                         "<br/>(—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –≤—ã–¥–≤–∏–∂–µ–Ω–∏–π - ", 
                         scales::number(nrow(cand_stat), 
                                        big.mark = ","), ")"))
  
gg2 <- sud_stat |> 
  rename(value = sh_cand) %>% 
 mutate(value_label = ifelse(value<0.00001, "0%", 
                              scales::percent(value, accuracy = 0.1))) %>% 
  tilemap_base() + 
  labs(subtitle = paste0("–î–æ–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é, %", 
                         "<br/>(—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ - ", 
                         scales::number(n_distinct(cand_stat$personId), 
                                        big.mark = ","), ")"))

ggsave(plot = gg1 + gg2 + 
         plot_annotation(caption= regina_caption,
           title = "–£—á–∞—Å—Ç–∏–µ –≤ –≤—ã–±–æ—Ä–∞—Ö  –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é (2009-2023)", 
           theme = my_theme_x), 
       filename=sh_place1, width=22, height = 12.5, units="cm", dpi=196)
}
knitr::include_graphics(sh_place1) 
```

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –∫–∞—Ä—Ç—É –ø–æ—Å—Ç—Ä–æ–∏–º –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—É–¥–∏–º–æ—Å—Ç—è–º–∏.

```{r}
data_tag <- "cands_share2"    # <- will be used in the chart filenames!
sh_place2 <- paste0(dir_charts, data_tag, "_kaluga_tiles2.png")
if(!file.exists(sh_place2)){

  gg1 <- sud_stat |> 
    rename(value = sh_place2) %>% 
    mutate(value_label = ifelse(value<0.00001, "0%", 
                                scales::percent(value, accuracy = 0.1))) %>% 
    tilemap_base() + 
    labs(subtitle = paste0("–ß–∞—Å—Ç–æ—Ç–∞ —É—á–∞—Å—Ç–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å 1+ —Å—É–¥–∏–º–æ—Å—Ç—è–º–∏, %", 
                           "<br/>(—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–æ –≤—ã–¥–≤–∏–∂–µ–Ω–∏–π - ", 
                           scales::number(nrow(cand_stat), 
                                          big.mark = ","), ")"))
    
  gg2 <- sud_stat |> 
    rename(value = sh_cand2) %>% 
   mutate(value_label = ifelse(value<0.00001, "0%", 
                                scales::percent(value, accuracy = 0.1))) %>% 
    tilemap_base() + 
    labs(subtitle = paste0("–î–æ–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å 1+ —Å—É–¥–∏–º–æ—Å—Ç—è–º–∏, %", 
                           "<br/>(—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ - ", 
                           scales::number(n_distinct(cand_stat$personId), 
                                          big.mark = ","), ")"))
  
  ggsave(plot = gg1 + gg2 + 
           plot_annotation(
             caption= regina_caption,
             title = "–£—á–∞—Å—Ç–∏–µ –≤ –≤—ã–±–æ—Ä–∞—Ö  –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å 1+ —Å—É–¥–∏–º–æ—Å—Ç—è–º–∏ (2009-2023)", 
             theme = my_theme), 
         filename = sh_place2,  
            width = 22, height = 12.5, units="cm", dpi=196
         ) 
}
knitr::include_graphics(sh_place2) 
```

### –û —Å—É–¥–∏–º–æ—Å—Ç—è—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤

> –ö–∞–Ω–¥–∏–¥–∞—Ç, –≤—ã–¥–≤–∏–≥–∞—è—Å—å –Ω–∞ –≤—ã–±–æ—Ä–∞—Ö, –æ–±—è–∑–∞–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–≤–æ–µ–π —Å—É–¥–∏–º–æ—Å—Ç–∏, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∞ —Å–Ω—è—Ç–∞ –∏–ª–∏ –ø–æ–≥–∞—à–µ–Ω–∞. –°–≤–µ–¥–µ–Ω–∏—è –æ–± —ç—Ç–æ–º –¥–æ–ª–∂–Ω—ã –±—É–¥—É—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –≤ –±—é–ª–ª–µ—Ç–µ–Ω–µ –∏ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å—Ç–µ–Ω–¥–∞—Ö, –≥–¥–µ –≤—ã–≤–µ—à–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–Ω–¥–∏–¥–∞—Ç–µ.[–°–≤–µ–¥–µ–Ω–∏—è –æ —Å—É–¥–∏–º–æ—Å—Ç–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑–±–∏—Ä–∞—Ç–µ–ª—è–º –Ω–∞ –≤—ã–±–æ—Ä–∞—Ö. –†–ò–ê –ù–æ–≤–æ—Å—Ç–∏. 19.02.2014](https://ria.ru/20140219/995752738.html){target="_blank"}

> –ö–∞–Ω–¥–∏–¥–∞—Ç –≤–ø—Ä–∞–≤–µ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –¥–µ–∫—Ä–∏–º–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç—å–∏, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –±—ã–ª –æ—Å—É–∂–¥–µ–Ω. [–ö–° –†–§: –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –≤—ã–±–æ—Ä–∞—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–æ–±—â–∞—Ç—å –æ —Å—É–¥–∏–º–æ—Å—Ç–∏ –¥–∞–∂–µ –ø—Ä–∏ –∞–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏. –¢–ê–°–°. 05.04.2016](https://tass.ru/politika/3177664){target="_blank"}

> –°–æ–∫—Ä—ã—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Å—É–¥–∏–º–æ—Å—Ç–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã —Å—Ç–∞–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–æ–π –ø—Ä–∏—á–∏–Ω–æ–π –¥–ª—è –æ—Ç–∫–∞–∑–∞ –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: –ø–æ –¥–∞–Ω–Ω—ã–º –¶–ò–ö, –≤ 2014 –≥. –æ—Ä–≥–∞–Ω—ã –ú–í–î –≤—ã—è–≤–∏–ª–∏ 240 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –æ—Ç 28 –ø–∞—Ä—Ç–∏–π, –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–≤—à–∏—Ö –Ω–µ–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ —Å—É–¥–∏–º–æ—Å—Ç–∏. –ü—Ä–æ–±–ª–µ–º—ã –±—ã–ª–∏ —É –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏–π, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π —Å–ª—É–∂–±—ã –ö–ü–†–§ –í–∞–¥–∏–º –°–æ–ª–æ–≤—å–µ–≤: —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞—Ç—å —Å—É–¥–∏–º–æ—Å—Ç—å –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–æ–∑–Ω–∏–∫–∞–ª–∏ –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —á–µ—Ç–∫–∏—Ö –∏ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª. ["–ò–∑–±–∏—Ä–∞—Ç–µ–ª–∏ –≤–ø—Ä–∞–≤–µ –∑–Ω–∞—Ç—å –æ —Å—É–¥–∏–º–æ—Å—Ç–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–∞–∂–µ –≤ —Å–ª—É—á–∞–µ –∞–º–Ω–∏—Å—Ç–∏–∏". –ì–∞–∑–µ—Ç–∞ "–í–µ–¥–æ–º–æ—Å—Ç–∏". 06.04.2016](https://www.vedomosti.ru/politics/articles/2016/04/06/636604-sudimosti-kandidatov){target="_blank"}

> –ó–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å –æ–±—è–∑–∞–ª –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ —Å–≤–æ–∏—Ö –∑–∞—è–≤–ª–µ–Ω–∏—è—Ö –æ —Å–æ–≥–ª–∞—Å–∏–∏ –±–∞–ª–ª–æ—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —É–∫–∞–∑—ã–≤–∞—Ç—å —Å–≤–µ–¥–µ–Ω–∏—è –æ –∫–æ–≥–¥–∞-–ª–∏–±–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å—É–¥–∏–º–æ—Å—Ç—è—Ö –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ , ‚Äì —Å–∫–∞–∑–∞–ª–∞ –ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å –¶–ò–ö –†–æ—Å—Å–∏–∏. ‚Äì –ê –µ—Å–ª–∏ —Å—É–¥–∏–º–æ—Å—Ç—å —Å–Ω—è—Ç–∞ –∏–ª–∏ –ø–æ–≥–∞—à–µ–Ω–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Å–≤–µ–¥–µ–Ω–∏—è –æ –¥–∞—Ç–µ —Å–Ω—è—Ç–∏—è –∏–ª–∏ –ø–æ–≥–∞—à–µ–Ω–∏—è —Å—É–¥–∏–º–æ—Å—Ç–∏. –ó–∞ —Ç—Ä–∏ —Å –ø–æ–ª–æ–≤–∏–Ω–æ–π –≥–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏—è —ç—Ç–æ–π –Ω–æ—Ä–º—ã, ‚Äì –ø—Ä–æ–¥–æ–ª–∂–∏–ª–∞ –≠–ª–ª–∞ –ü–∞–º—Ñ–∏–ª–æ–≤–∞, ‚Äì –æ–∫–æ–ª–æ 250 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–µ –±—ã–ª–∏ –¥–æ–ø—É—â–µ–Ω—ã –Ω–∞ –≤—ã–±–æ—Ä—ã —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π, —Ç–∞–∫ –∫–∞–∫ –Ω–∞ –¥–µ–Ω—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –Ω–µ –ø—Ä–æ—à–ª–æ 10 –∏–ª–∏ 15 –ª–µ—Ç —Å –º–æ–º–µ–Ω—Ç–∞ —Å–Ω—è—Ç–∏—è –∏–ª–∏ –ø–æ–≥–∞—à–µ–Ω–∏—è —Ç—è–∂–∫–∏—Ö –∏–ª–∏ –æ—Å–æ–±–æ —Ç—è–∂–∫–∏—Ö —Å—É–¥–∏–º–æ—Å—Ç–µ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ò–ª–∏ –∏–º–µ–ª–∏—Å—å —Å—É–¥–µ–±–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø–æ –∏—Ö —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏¬ª. ["–†–∞–∑—ä—è—Å–Ω–µ–Ω–∏–µ –¶–ò–ö –†–æ—Å—Å–∏–∏ –æ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –Ω–æ—Ä–º–∞—Ö –ø–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—é –ø—Ä–∞–≤–∞ –±—ã—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–º–∏ –ª–∏—Ü, –∏–º–µ–≤—à–∏—Ö —Å—É–¥–∏–º–æ—Å—Ç—å". –°–∞–π—Ç –¶–ò–ö –†–æ—Å—Å–∏–∏. 15.11.2017](http://www.cikrf.ru/news/cec/23508/){target="_blank"}

> –û–∫–æ–ª–æ 2,2% —Ä–µ—à–∏–≤—à–∏—Ö –±–∞–ª–ª–æ—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è 9 —Å–µ–Ω—Ç—è–±—Ä—è –≤ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏ –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–µ –¥–µ–ø—É—Ç–∞—Ç—ã –∏–º–µ—é—Ç —Å—É–¥–∏–º–æ—Å—Ç—å. [–ö–∞–∂–¥—ã–π 50-–π: —Å–∫–æ–ª—å–∫–æ –ø—Ä–µ—Ç–µ–Ω–¥–µ–Ω—Ç–æ–≤ –≤ –¥–µ–ø—É—Ç–∞—Ç—ã –∑–∞—è–≤–∏–ª–∏ –æ —Å–≤–æ–µ–π —Å—É–¥–∏–º–æ—Å—Ç–∏. –†–ë–ö. 04.09.2018](https://www.rbc.ru/politics/04/09/2018/5b87bc129a7947d592b5a193){target="_blank"}

–í –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –¥–æ–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é –≤ –≤—ã–±–æ—Ä–∞—Ö 2009-2023 –≥–≥. -- **`r scales::percent(171/n_distinct(cand_stat$personId),0.01)`** (–≤ —Ü–µ–ª–æ–º, –∫–∞–∫ –ø–æ —Å—Ç—Ä–∞–Ω–µ).

### –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç–µ–π –£–ö

–í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—å—è–º –£–ö. –°—Ç–∞—Ç—å–∏ —Ä–∞–∑–Ω—ã—Ö –∫–æ–¥–µ–∫—Å–æ–≤ (–†–§, –°–°–°–† –∏ –Ω–µ–∫–æ–ª—å–∫–∏—Ö –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω) –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ —Å—Ç–æ–ª–±—Ü–µ "–°—Ç–∞—Ç—å–∏" –∏ —Ç–∞–º, –≥–¥–µ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ, –æ—Ç–Ω–µ—Å–µ–Ω—ã –∫ —Ä–∞–∑–¥–µ–ª–∞–º –∏ –≥–ª–∞–≤–∞–º –¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ –£–ö –†–§. 

```{r}
statyi_m <- readxl::read_xlsx(paste0(dir0, "sudim_articles.xlsx")) |> 
  select(razdel, glava, article, unified_cat) |> 
  distinct()

statyi <- cand_stat %>% filter(!is.na(n_crimes)) %>%  
  mutate(st = str_split(arts, "\\|")) %>% 
  unnest(st, keep_empty = T) %>% 
  mutate(st = str_squish(st)) |> 
  mutate(st = str_replace_all(st, 
                              enc2utf8("(—Å—Ç.[\\d]+)(.+?)(–£–ö [^\\s]+)(.+)"), 
                              "\\1 \\3|\\4")) |>
  separate(st, c("article", "descr"),  "\\|") |> 
  mutate(descr = str_squish(descr)) |>
  replace_na(list(article = "xxx")) |> 
  left_join(statyi_m, by = join_by(article))

statyi1 <- statyi |> 
  group_by(razdel, glava) |> 
  arrange(desc(grepl("–£–ö –†–§", article)), article) |> 
  summarize(articles = paste(unique(article), collapse = "; "),
            n_cands = n_distinct(personId), 
            n_elections = n_distinct(url_event)) |> 
  arrange(razdel, glava, articles)

statyi2 <- statyi |> 
  group_by(razdel, glava, unified_cat) |> 
  arrange(desc(grepl("–£–ö –†–§", article)), article) |> 
  summarize(articles = paste(unique(article), collapse = "; "),
            n_cands = n_distinct(personId), 
            n_elections = n_distinct(url_event)) |> 
  ungroup() %>% 
  arrange(razdel, glava, articles)

statyi2 |> 
  mutate(razdel = gsub("\\.\\.\\. –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏", "...", razdel)) |> 
  mutate(unified_cat = ifelse(is.na(glava), paste0(unified_cat, " (", razdel, ")"), unified_cat)) |> 
  mutate(razdel = ifelse(is.na(glava), NA_character_, razdel)) |> 
  mutate(unified_cat = ifelse(unified_cat=="NA (NA)", "–°—Ç–∞—Ç—å—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞", unified_cat)) |>
  arrange(-n_elections) |> 
  DT::datatable(rownames = F, 
                caption = htmltools::tags$caption(style = table_caption_css, paste0(' ')), 
          options = list(pageLength = 5, 
                         columnDefs = list(list(className = 'dt-center', targets = c(4:5)),
                                      list(width = '180px', targets = c(0,1)),
                                      list(width = '120px', targets = c(3)),
                                      list(width = '350px', targets = c(2)))),
          colnames = c("–†–∞–∑–¥–µ–ª" = "razdel", "–ì–ª–∞–≤–∞" = "glava", 
                       "–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏" = "unified_cat", 
                       "–°—Ç–∞—Ç—å–∏" = "articles", 
                       "–ö–∞–Ω–¥" ="n_cands", "–í—ã–¥–≤" ="n_elections"))
```

> –°–∞–º—ã–µ —á–∞—Å—Ç—ã–µ —Å—Ç–∞—Ç—å–∏ -- –ö—Ä–∞–∂–∞ –∏ –•—É–ª–∏–≥–∞–Ω—Å—Ç–≤–æ, –Ω–æ —Å–ø–µ–∫—Ç—Ä –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç -- –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≥—Ä–∞–±—ë–∂, –ø–æ–±–æ–∏, —É–º—ã—à–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏—á–∏–Ω–µ–Ω–∏–µ —Ç—è–∂–∫–æ–≥–æ –≤—Ä–µ–¥–∞ –∑–¥–æ—Ä–æ–≤—å—é, –∏–∑–Ω–∞—Å–∏–ª–æ–≤–∞–Ω–∏–µ, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–Ω—É–∂–¥–µ–Ω–∏–µ... –∏–º–µ–Ω–Ω–æ –ø–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ **—Å—Ç–æ–∏—Ç —Ö–æ–¥–∏—Ç—å –Ω–∞ –≤—Å–µ –≤—ã–±–æ—Ä—ã –∏ —Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞ —á—Ç–æ —Ç–∞–∫ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –≥–æ–ª–æ—Å–æ–≤–∞—Ç—å**. 

***

–ù—Ä–∞–≤—è—Ç—Å—è –Ω–∞—à–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã? üëâ –¢–ì-–∫–∞–Ω–∞–ª [Regina Lab](https://t.me/+lviW66SN9gQ1YTky){target="_blank"}  

***

### –ü–æ–¥–µ–ª–∏—Ç—å—Å—è {.appendix}

<div class="a2a_kit a2a_kit_size_32 a2a_default_style" data-a2a-icon-color="unset">
<a class="a2a_button_telegram"></a>
<a class="a2a_button_vk"></a>
<a class="a2a_button_odnoklassniki"></a>
<a class="a2a_button_email"></a>
<a class="a2a_button_livejournal"></a>
<a class="a2a_button_mastodon"></a>
<a class="a2a_button_x"></a>
<a class="a2a_button_wechat"></a>
<a class="a2a_button_whatsapp"></a>
<a class="a2a_button_facebook_messenger"></a>
<a class="a2a_button_viber"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>

### –°—Å—ã–ª–∫–∞ –¥–ª—è —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è {.appendix}

–í—ã–±–æ—Ä—ã –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ (–ß–∞—Å—Ç—å 1. –ö–∞–Ω–¥–∏–¥–∞—Ç—ã —Å —Å—É–¥–∏–º–æ—Å—Ç—å—é). // –ë–ª–æ–≥ Regina Lab. - 2024. - URL: https://reginaobninsklab.github.io/posts/kaluga-elections-part1-sudimost/. - –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: 30 –∏—é–Ω—è 2024 –≥.

### –ü—Ä–∞–≤–∞ {.appendix}

–ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–Ω–æ–µ, —Ç–æ —Å—Ç–∞—Ç—å—è —Ü–µ–ª–∏–∫–æ–º –∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –µ—ë —Ç–µ–∫—Å—Ç, –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —É—Å–ª–æ–≤–∏—è—Ö –ø—É–±–ª–∏—á–Ω–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏ [Creative Commons CC BY 4.0 Deed Attribution 4.0 International](https://creativecommons.org/licenses/by/4.0/deed.ru){target="_blank"}.

### –û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ {.appendix}

[–°–º. —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª](https://reginaobninsklab.github.io/about.html#warranty){target="_blank"} –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–û –ø—Ä–æ–µ–∫—Ç–µ".

### –°–æ—Ñ—Ç {.appendix}

```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
pkgs <- c('dplyr', 'readr', 'tidyr', 'purrr', 'stringr', 'ggplot2', 'ggimage', 'knitr', 'magick', 'sf', 'rmarkdown', 'scales', 'showtext', 'sysfonts', 'patchwork', 'ggtext')

do.call('c',lapply(pkgs, citation)) %>% sort()
```

Allaire J, Xie Y, Dervieux C, McPherson J, Luraschi J, Ushey K, Atkins A, Wickham H, Cheng J, Chang W,
Iannone R (2023). _rmarkdown: Dynamic Documents for R_. R package version 2.22,
<https://github.com/rstudio/rmarkdown>.

Ooms J (2023). _magick: Advanced Graphics and Image-Processing in R_. R package version 2.8.2,
<https://CRAN.R-project.org/package=magick>.

Pebesma E (2018). ‚ÄúSimple Features for R: Standardized Support for
Spatial Vector Data.‚Äù _The R Journal_, *10*(1), 439-446. doi:
10.32614/RJ-2018-009 (URL: https://doi.org/10.32614/RJ-2018-009),
<URL: https://doi.org/10.32614/RJ-2018-009>.

Pedersen T (2024). _patchwork: The Composer of Plots_. R package version 1.2.0,
<https://CRAN.R-project.org/package=patchwork>.

Qiu Y, details. aotifSfAf (2022). _sysfonts: Loading Fonts into R_. R package version 0.8.8,
<https://CRAN.R-project.org/package=sysfonts>.

Qiu Y, details. aotisSfAf (2023). _showtext: Using Fonts More Easily in R Graphs_. R package version 0.9-6,
<https://CRAN.R-project.org/package=showtext>.

Wickham H (2022). _stringr: Simple, Consistent Wrappers for Common String Operations_. R package version
1.5.0, <https://CRAN.R-project.org/package=stringr>.

Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_. Springer-Verlag New York. ISBN
978-3-319-24277-4, <https://ggplot2.tidyverse.org>.

Wickham H, Fran√ßois R, Henry L, M√ºller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. R
package version 1.1.2, <https://CRAN.R-project.org/package=dplyr>.

Wickham H, Henry L (2023). _purrr: Functional Programming Tools_. R package version 1.0.1,
<https://CRAN.R-project.org/package=purrr>.

Wickham H, Hester J, Bryan J (2023). _readr: Read Rectangular Text Data_. R package version 2.1.4,
<https://CRAN.R-project.org/package=readr>.

Wickham H, Seidel D (2022). _scales: Scale Functions for Visualization_. R package version 1.2.1,
<https://CRAN.R-project.org/package=scales>.

Wickham H, Vaughan D, Girlich M (2023). _tidyr: Tidy Messy Data_. R package version 1.3.0,
<https://CRAN.R-project.org/package=tidyr>.

Wilke C, Wiernik B (2022). _ggtext: Improved Text Rendering Support for 'ggplot2'_. R package version
0.1.2, <https://CRAN.R-project.org/package=ggtext>.

Xie Y (2023). _knitr: A General-Purpose Package for Dynamic Report Generation in R_. R package version
1.43, <https://yihui.org/knitr/>.

Xie Y (2015). _Dynamic Documents with R and knitr_, 2nd edition. Chapman and Hall/CRC, Boca Raton, Florida.
ISBN 978-1498716963, <https://yihui.org/knitr/>.

Xie Y (2014). ‚Äúknitr: A Comprehensive Tool for Reproducible Research in R.‚Äù In Stodden V, Leisch F, Peng RD
(eds.), _Implementing Reproducible Computational Research_. Chapman and Hall/CRC. ISBN 978-1466561595.

Xie Y, Allaire J, Grolemund G (2018). _R Markdown: The Definitive Guide_. Chapman and Hall/CRC, Boca Raton,
Florida. ISBN 9781138359338, <https://bookdown.org/yihui/rmarkdown>.

Xie Y, Dervieux C, Riederer E (2020). _R Markdown Cookbook_. Chapman and Hall/CRC, Boca Raton, Florida.
ISBN 9780367563837, <https://bookdown.org/yihui/rmarkdown-cookbook>.

Yu G (2023). _ggimage: Use Image in 'ggplot2'_. R package version 0.3.3,
<https://CRAN.R-project.org/package=ggimage>.


